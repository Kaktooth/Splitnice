CREATE TABLE "user"
(
    id       SERIAL PRIMARY KEY,
    username VARCHAR,
    email    VARCHAR,
    phone    VARCHAR
);


CREATE TABLE business_entity
(
    id SERIAL PRIMARY KEY
);

CREATE TABLE account
(
    id        SERIAL PRIMARY KEY,
    username  VARCHAR,
    amount    DECIMAL,
    email     VARCHAR,
    phone     VARCHAR,
    entity_id INTEGER
        CONSTRAINT fk_entity
            REFERENCES business_entity (id)
);

CREATE TABLE "group"
(
    id         SERIAL PRIMARY KEY,
    title      VARCHAR,
    creator_id INTEGER
        CONSTRAINT fk_creator
            REFERENCES account (id),
    entity_id  INTEGER
        CONSTRAINT fk_entity
            REFERENCES business_entity (id)
);

CREATE TABLE account_user
(
    id_account INTEGER
        CONSTRAINT fk_account
            REFERENCES account (id),
    id_user    INTEGER
        CONSTRAINT fk_user
            REFERENCES "user" (id)
);

CREATE TABLE group_account
(
    id          SERIAL PRIMARY KEY,
    role        VARCHAR,
    added_by_id INTEGER
        CONSTRAINT fk_added_by
            REFERENCES account (id),
    group_id    INTEGER
        CONSTRAINT fk_group
            REFERENCES "group" (id),
    account_id  INTEGER
        CONSTRAINT fk_account
            REFERENCES account (id)
);

CREATE TABLE balance
(
    id           SERIAL PRIMARY KEY,
    amount       DECIMAL,
    balance_type VARCHAR,
    owner        INTEGER
        CONSTRAINT fk_owner
            REFERENCES "group" (id)
);

CREATE TABLE currency
(
    id            SERIAL PRIMARY KEY,
    title         VARCHAR,
    exchange_rate DECIMAL,
    change_date   TIMESTAMP
);

CREATE TABLE expense
(
    id            SERIAL PRIMARY KEY,
    amount        DECIMAL,
    creation_date TIMESTAMP,
    landed_by_id  INTEGER
        CONSTRAINT fk_landed_by_id
            REFERENCES business_entity (id),
    landed_to_id  INTEGER
        CONSTRAINT fk_landed_to_id
            REFERENCES business_entity (id),
    currency_id   INTEGER
        CONSTRAINT fk_currency_id
            REFERENCES currency (id)
);